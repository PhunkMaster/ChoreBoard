{% extends "base.html" %}

{% block title %}ChoreBoard - Leaderboard{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Header -->
    <div class="text-center">
        <h1 class="text-4xl font-bold text-white mb-2">üèÜ Leaderboard</h1>
        <p class="text-gray-400">See who's earning the most {{ POINTS_LABEL }}!</p>
    </div>

    <!-- Tab Switcher -->
    <div class="flex justify-center">
        <div class="bg-dark-surface rounded-lg p-1 inline-flex" role="tablist">
            <a href="?type=weekly"
               class="px-6 py-3 rounded-md font-semibold transition {% if board_type == 'weekly' %}bg-primary-600 text-white{% else %}text-gray-400 hover:text-white{% endif %}"
               role="tab"
               aria-selected="{% if board_type == 'weekly' %}true{% else %}false{% endif %}">
                Weekly
            </a>
            <a href="?type=alltime"
               class="px-6 py-3 rounded-md font-semibold transition {% if board_type == 'alltime' %}bg-primary-600 text-white{% else %}text-gray-400 hover:text-white{% endif %}"
               role="tab"
               aria-selected="{% if board_type == 'alltime' %}true{% else %}false{% endif %}">
                All-Time
            </a>
        </div>
    </div>

    <!-- Leaderboard -->
    <div class="max-w-3xl mx-auto">
        {% if ranked_list %}
        <div class="space-y-3">
            {% for entry in ranked_list %}
            <div class="bg-dark-surface rounded-lg p-6 border {% if entry.rank == 1 %}border-yellow-500 shadow-lg shadow-yellow-500/20{% elif entry.rank == 2 %}border-gray-400{% elif entry.rank == 3 %}border-amber-600{% else %}border-dark-border{% endif %}
                        hover:border-primary-500 transition">
                <div class="flex items-center justify-between">
                    <!-- Rank -->
                    <div class="flex items-center space-x-4">
                        <div class="text-center w-12">
                            {% if entry.rank == 1 %}
                            <span class="text-4xl">ü•á</span>
                            {% elif entry.rank == 2 %}
                            <span class="text-4xl">ü•à</span>
                            {% elif entry.rank == 3 %}
                            <span class="text-4xl">ü•â</span>
                            {% else %}
                            <span class="text-2xl font-bold text-gray-500">#{{ entry.rank }}</span>
                            {% endif %}
                        </div>

                        <!-- User Info -->
                        <div>
                            <h3 class="text-xl font-semibold text-white">
                                {{ entry.user.get_display_name }}
                            </h3>
                            <p class="text-gray-400 text-sm">@{{ entry.user.username }}</p>
                        </div>
                    </div>

                    <!-- Points -->
                    <div class="text-right">
                        <p class="text-3xl font-bold {% if entry.rank == 1 %}text-yellow-400{% elif entry.rank == 2 %}text-gray-300{% elif entry.rank == 3 %}text-amber-500{% else %}text-primary-400{% endif %}">
                            {{ entry.points }}
                        </p>
                        <p class="text-gray-500 text-sm">{{ POINTS_LABEL }}</p>
                    </div>
                </div>

                <!-- Progress bar for visual ranking -->
                {% if ranked_list.0.points > 0 %}
                <div class="mt-4 bg-dark-card rounded-full h-2 overflow-hidden">
                    <div class="h-full {% if entry.rank == 1 %}bg-yellow-500{% elif entry.rank == 2 %}bg-gray-400{% elif entry.rank == 3 %}bg-amber-600{% else %}bg-primary-500{% endif %} transition-all duration-500"
                         style="width: {% widthratio entry.points ranked_list.0.points 100 %}%"></div>
                </div>
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="bg-dark-surface rounded-lg p-12 text-center border border-dark-border">
            <svg class="w-16 h-16 mx-auto text-gray-600 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
            </svg>
            <h3 class="text-xl font-semibold text-gray-300 mb-2">No rankings yet</h3>
            <p class="text-gray-500">Complete some chores to appear on the leaderboard!</p>
        </div>
        {% endif %}
    </div>

    <!-- Info Card -->
    <div class="max-w-3xl mx-auto mt-8">
        <div class="bg-primary-900/20 border border-primary-500/30 rounded-lg p-6">
            <div class="flex items-start space-x-3">
                <svg class="w-6 h-6 text-primary-400 flex-shrink-0 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <div>
                    <h4 class="font-semibold text-white mb-1">About the Leaderboard</h4>
                    <p class="text-gray-400 text-sm">
                        {% if board_type == 'weekly' %}
                        The weekly leaderboard tracks {{ POINTS_LABEL }} earned this week. {{ POINTS_LABEL|title }} reset every Sunday at midnight.
                        {% else %}
                        The all-time leaderboard shows total {{ POINTS_LABEL }} earned since the beginning. These {{ POINTS_LABEL }} never reset!
                        {% endif %}
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    // Add custom template filters for math operations
    // Note: These would normally be Django template filters, but for demonstration:
    // The template uses inline style calculations that Django will process server-side
</script>
{% endblock %}
