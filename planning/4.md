### Locked-in decisions and next steps
Thanks — your answers give us enough to start building. Here’s the finalized plan reflecting your choices, plus a few tiny confirmations to ensure smooth implementation.

---

### Finalized behavior summary
- Packaging & runtime
  - Single Docker image; Django + HTMX + Tailwind (dark, touch‑optimized); static via WhiteNoise.
  - APScheduler inside the web process for: midnight evaluations, minutely distribution checks, weekly snapshot.

- Users and permissions
  - Two independent per‑user flags:
    - `can_be_assigned` (rotation/force‑assignment pool)
    - `eligible_for_points` (can receive “Phil(s)” and appear on leaderboard)
  - Public kiosk: claim/complete allowed without login; admin tools require login at a separate URL.

- Scheduling and recurrence
  - Daily, Weekly, Every N days (with explicit start date and late completion shifting next due = completion + N days), and advanced rules via RRULE (JSON stored, easy to change later).
  - Weekly due at midnight on the target day; overdue at the following midnight.

- Assignment & rotation
  - Default distribution time 17:30, overrideable per chore; global default also overrideable via env var.
  - Auto‑assign order: eligible users → exclude last period’s completers → fewest force‑assignments today → random tie‑break.
  - If no eligible candidate remains, do not fallback; leave as “purple” with a reason for admin.
  - Difficult chores: auto‑assigner avoids giving someone a second difficult chore the same day; users may still claim another difficult chore (warning shown).

- Claims
  - 1 claim per user/day; admin undo restores the daily claim allowance.

- Points (“Phil/Phils”)
  - Equal split only among helpers; round to 2 decimals; no user can go below 0 in weekly or all‑time totals after undo.
  - If only ineligible helpers completed the chore: distribute points equally among points‑eligible users who are also eligible for that chore (your choice 2b).
  - Admin‑only conversion (100 points = $1). Labels configurable via env.

- Streaks
  - Global streak; resets if any overdue in the week; admin can override.

- Logs
  - Evaluation and action logs (30‑day retention).

- “Late chore” vs “tardy”
  - We will NOT implement “tardy” at this time (per your choice to ignore it).
  - We WILL implement the boolean chore category `is_late_chore` (“intended after dinner”).
  - API will expose outstanding “late chore” items assigned to a user (see APIs below).

- Dependency recurrence
  - Child chore spawns when parent completes; if parent is undone, delete child if open; if child already completed, auto‑undo child (revert points) and delete the child instance.

- Pages (for Home Assistant iframes)
  - Public routes:
    - `/board/user/<username>` — that user’s assigned chores
    - `/board/pool` — pool only
    - `/leaderboard` — weekly and all‑time
    - `/board` — overview (if you ever want it)

- REST API (initial)
  - `GET /api/users/<id-or-username>/late-chores` — outstanding (assigned to that user) chores with `is_late_chore=true`, not completed; today’s scope by default.
  - `GET /api/leaderboard?range=weekly|alltime` — public.
  - `POST /api/instances/{id}/complete` — public completion flow with helper selection, HMAC token required.
  - `POST /api/instances/{id}/claim` — public claim (enforces 1/day), HMAC token required.
  - `POST /api/instances/{id}/undo` — admin-only (login required).

- Security (public kiosk)
  - Use a kiosk‑scoped HMAC token embedded in the board page for POSTs (no cookies needed) — your choice 9B.

- Docker & persistence
  - SQLite with a mountable path (configurable env var). Static files baked at build time. Easy to mount `/data`.

- Embedding
  - Allow iframe embedding from an env var domain list (e.g., `home.phunkmaster.com`).

---

### Environment variables (draft)
- App/Django: `DJANGO_SECRET_KEY`, `DJANGO_DEBUG`, `DJANGO_ALLOWED_HOSTS`
- Timezone: `APP_TIMEZONE` (default `America/Chicago`)
- Distribution: `DEFAULT_DISTRIBUTION_TIME=17:30` (HH:MM)
- Points labels: `POINTS_LABEL_SINGULAR=Phil`, `POINTS_LABEL_PLURAL=Phils`
- Logs retention: `RETENTION_DAYS=30`
- Embedding/CSP: `ALLOWED_IFRAME_ORIGINS=home.phunkmaster.com` (comma‑sep list)
- Kiosk security: `KIOSK_HMAC_SECRET=<random>`
- SQLite path: `DB_PATH=/data/db.sqlite3` (so you can `-v` mount `/data`)

---

### Tiny confirmations (please reply with brief choices)
1) Display names on public pages: use `first_name` if set, else `username`? Or always `username`?
2) Claim dialog user list: show users with `can_be_assigned=true` (recommended) — OK?
3) Per‑user routes: usernames may include spaces/case; do you prefer slugged usernames in URLs (recommended), or we enforce ASCII usernames at account creation?
4) Dependency cycles: I will hard‑block circular dependencies in admin — OK?
5) Undo of forced assignment: when an auto‑assigned instance is undone, I will decrement today’s force‑assignment count used for rotation fairness — OK?
6) Advanced recurrence editor: initial UI will accept either a small preset picker (e.g., “1st & 3rd Friday”, “Mon & Wed”) or raw RRULE text; we’ll store RRULE JSON. Is that acceptable for v1?
7) Outstanding non‑late chores API: do you also want `GET /api/users/<id>/non-late-outstanding` (assigned to user, not completed) for the internet‑access check logic? It complements the `late-chores` endpoint.
8) Colors: green (on‑time), red (overdue), purple (assignment issue). I’ll use a blue tag to indicate “Late chore” category on cards — OK?
9) Leaderboard: public view shows display names only (no emails) — OK?

---

### After your reply
I’ll begin implementation (models/migrations, scheduler, REST, UI, Dockerfile), then share the first runnable image and endpoints so you can start wiring HA dashboard pages with the dedicated URLs.